# Flash3D: 单张图像的前馈式通用3D场景重建

## Stanislaw Szymanowicz\*
VGG, 牛津大学  
stan@robots.ox.ac.uk

## Eldar Insafutdinov\*
VGG, 牛津大学  
eldar@robots.ox.ac.uk

## Chuanxia Zheng\*
VGG, 牛津大学  
cxzheng@robots.ox.ac.uk

## Dylan Campbell
澳大利亚国立大学  
dylan.campbell@anu.edu.au

## João F. Henriques
VGG, 牛津大学  
joao@robots.ox.ac.uk

## Christian Rupprecht
VGG, 牛津大学  
chrisr@robots.ox.ac.uk

## Andrea Vedaldi
VGG, 牛津大学  
vedaldi@robots.ox.ac.uk

## 摘要
在本文中，我们提出了Flash3D，这是一种场景重建和新视图合成的方法，只需要单张图像，且具备很强的通用性和高效性。为了通用性，我们从单目深度估计的“基础”模型开始，并将其扩展为完整的3D形状和外观重建器。为了高效性，我们基于前馈高斯散射进行扩展。具体来说，我们首先在预测深度处预测3D高斯分布，然后添加偏移的高斯分布层，允许模型在遮挡和截断之间完成重建。Flash3D非常高效，在单个GPU上一天内即可训练完毕，因此大多数研究人员都能使用它。它在训练并在RealEstate10k上测试时取得了最先进的结果。当转移到未见过的数据集NYU时，它以很大优势超越了竞争对手。更为显著的是，当转移到KITTI时，Flash3D在PSNR上超过了专门针对该数据集训练的方法。在某些情况下，它甚至超越了使用多视图输入的最新方法。代码、模型、演示和更多结果可在[此处](https://www.robots.ox.ac.uk/~vgg/research/flash3d/)获得。

## 1 介绍
我们考虑通过网络的一次前馈传递从单张图像重建真实感3D场景的问题。这是一个具有挑战性的任务，因为场景复杂且单目重建是不适定的。单目设置中缺乏明确的几何线索，如三角测量，并且无法直接获得被遮挡部分的视图。

该问题与单目深度估计密切相关\[4, 6, 7, 16, 20, 33, 34, 46, 47, 56, 59, 90\]，这是一项成熟的技术。现在可以通过出色的跨域泛化\[47, 90, 91\]准确估计度量深度。然而，尽管深度估计器可以预测最近可见表面的3D形状，但它们并不提供任何外观信息，或者被遮挡或视野外部分的估计。仅深度不足以解决诸如新视图合成（NVS）等任务，这些任务还需要解决局部和视图依赖的外观。

尽管现代单目场景重建方法存在\[36, 74, 85\]，但它们大多在封闭环境中操作，即为每个特定数据集训练单独的网络。与之相反，现代的深度预测器在推理时对新数据集的泛化能力很好。此外，当前的单目场景重建器通常较慢或由于体积渲染\[36\]和隐式表示\[92\]而导致计算内存成本较高。

最近，Szymanowicz等人\[68\]介绍了Splatter Image（SI），这是一种基于高斯散射\[31\]成功的快速单目重建方法。该方法的实现很简单：为每个输入图像像素预测彩色3D高斯参数，使用标准的图像到图像神经网络架构。得到的高斯混合模型可以很好地重建对象，包括未观察到的表面。部分原因是SI可以使用一些“背景像素”来建模被遮挡的部分。然而，在场景重建中，并没有这样的背景像素储备，这对方法构成了挑战。相比之下，pixelSplat\[9\]，MVSplat\[11\]，latentSplat\[83\]和GS-LRM\[95\]，这些方法虽然共享类似的设计，旨在进行场景重建；然而，它们解决的是双目重建问题，需要两张已知视点的场景图像。我们考虑的是更具挑战性的单目设置，因为它更具普遍适用性且不需要相机外参，这本身就是一个具有挑战性的研究问题\[78, 80, 94\]。

在这项工作中，我们介绍了一种新的、简单、高效且高性能的单目场景重建方法，称为Flash3D。这基于两个关键理念。首先，我们解决了当前前馈单目场景重建器存在的通用性问题。目标是让Flash3D在任何场景中工作，而不仅仅是与训练集相似的场景。类似地，开放式模型通常称为基础模型，需要大量训练数据集和大多数研究小组无法使用的计算资源。3D重建和生成中也存在类似的问题\[35, 37, 40, 41, 60, 97\]，通过扩展到3D或使用现有基础2D图像或视频生成器\[5, 13, 19, 48, 53\]来解决。我们在此假设重建还可以从现有基础模型构建，但选择单目深度预测器作为更自然的选择。特别是，通过构建一个高质量的深度预测器\[47\]，我们可以实现对新数据集的出色泛化，以至于我们的3D重建比那些专门针对测试数据集训练的模型更准确。

其次，我们改进了用于单目场景重建的前馈逐像素高斯散射。正如所述，应用于单个对象，逐像素重建器可以使用背景像素建模对象的隐藏部分，但在重建整个场景时不可行。我们的解决方案是预测每个像素的多个高斯，其中只有第一个高斯沿光线一致以符合深度估计，从而建模场景的可见部分。这类似于分层表示\[1, 3, 36, 58, 74, 76\]和多高斯采样在pixelSplat\[9\]中的应用。然而，在我们的案例中，高斯是确定性的，不限于特定深度范围，模型是自由移动高斯以建模遮挡或截断的场景部分。

总体而言，Flash3D是一个简单且高性能的单目场景重建管道。经验表明，我们发现Flash3D可以(a)渲染高质量的重建3D场景图像；(b)在广泛的场景中操作，包括室内和室外；并且(c)重建被遮挡部分，这在仅深度估计或天真的扩展中是不可能实现的。Flash3D在所有指标上在RealEstate10K\[72\]上实现了最先进的新视图合成精度。

